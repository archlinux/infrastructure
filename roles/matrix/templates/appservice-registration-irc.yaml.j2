id: {{ vault_matrix_secrets.irc_appservice_id }}
hs_token: {{ vault_matrix_secrets.irc_hs_token }}
as_token: {{ vault_matrix_secrets.irc_as_token }}
namespaces:

  users:
{% for network in vault_matrix_secrets.irc_networks.values() %}
    - exclusive: true
      regex: '@{{ network.name | regex_escape() }}_.*:{{ matrix_server_name | regex_escape() }}'
      group_id: '+{{ network.name }}:{{ matrix_server_name }}'
{% endfor %}

  aliases:
{% for network in vault_matrix_secrets.irc_networks.values() %}
    - exclusive: true
      regex: '#{{ network.name | regex_escape() }}_.*:{{ matrix_server_name | regex_escape() }}'
{% endfor %}

  rooms:
{% for room in vault_matrix_secrets | json_query("irc_networks.*[].mappings.*[].room") %}
    - exclusive: false
      regex: '{{ room | regex_escape() }}'
{% endfor %}

url: 'http://127.0.0.1:8499'
sender_localpart: irc-bridge
rate_limited: false

# vim:set ft=yaml sw=2:
